<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="../css/main_theme.css" />

        <link rel="stylesheet" href="../ico/uicons-regular-rounded/css/uicons-regular-rounded.css" />
        <link rel="stylesheet" href="../ico/uicons-solid-rounded/css/uicons-solid-rounded.css" />
        <link rel="stylesheet" href="../css/style_navigation_bar.css"/>

        <link rel="stylesheet" href="../css/stylesheet_frags.css" />
        <link rel="stylesheet" href="../css/style_button.css"/>

        <link rel="stylesheet" href="../css/popup.css" />
        <link rel="stylesheet" href="../css/modal.css" />
        
        <link rel="stylesheet" href="../ico/uicons-brands/css/uicons-brands.css" />

        <!--moving.css-->
        <style>

            #moving-screen {
                position: fixed;
                top: 0;
                left: 101vw;
                width: 100vw;
                height: 100vh;
                background-color: var(--background-color);
                
                transition: var(--touch-transistion) ease-in-out;
                box-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
                display: none;
                z-index: 2;
            }

            #moving-screen.active {
                left: 0;
            }
        
        </style>

<!--same as add_vehicle-->
        <style>
            #screen_header {
                padding-top: 25px;
                padding-bottom: 10px;
                margin-bottom: 5px;
                display: grid;
                grid-template-columns: 1fr auto 1fr;
                box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
            }

            #screen_header a {
                text-decoration: none;
                color: var(--primary-color);
                font-size: 2em;
                margin-left: 15px;
                width: 32px;
                height: 32px;
            }

            #screen_header i {
                position: absolute;
                display: flex;
                align-items: center;

                transition: var(--touch-transistion);
                border-radius: 50%;
            }

            #screen_header i:active {
                background-color: rgba(0, 0, 0, 0.2);
            }

        </style>

        <!--setting.css-->
        <style>
            #page-content i {
                position: absolute;
                display: flex;
                align-items: center;
            }

            #user_info {
                margin: 20px;
                display: grid;
                grid-template-columns: 50% auto;
                align-items: center;
            }

            #user_name {
                font-size: 1.2em;
                font-weight: 600;
                text-align: end;
                padding: 0 10px;
            }

            .circle {
                width: fit-content;
                height: fit-content;
                border-radius: 50%;
                background: var(--primary-color);
                box-shadow: var(--border-shadow);
            }

            .circle i {
                position: relative !important;
                padding: 10px;
                color: white;
                font-size: 4em;
                text-shadow: var(--border-shadow);
            }


            /* Menu */
            #menu_setting {
                display: flex;
                flex-direction: column;
                margin: 0 20px;
            }

            .settings_button {
                padding: 15px;
                text-decoration: none;
                transition: var(--touch-transistion);
                border-radius: 50px;
                
                color: #444444;
                -webkit-tap-highlight-color: transparent;
            }

            .settings_button:active {
                color: white;
                background-color: var(--primary-color);
            }

            .settings_button span {
                margin-left: 2em;
            }

            .settings_button i {
                color: var(--primary-color);
            }
            
            #caution_container {
                display: flex;
                flex-direction: column;
                align-items: center;
                margin: 20px;
            }

            .caution_button {
                width: 200px;
                background-color: var(--primary-color);
                box-shadow: var(--border-shadow);
                color: white;
                font-weight: 600;
                margin: 10px;
            }
        </style>

        <!--setting_panel_pi.css-->
        <style>

            #set_sec_pi {
                margin: 0 20px;
            }

            #set_sec_pi h2 {
                font-size: 24px;
                font-weight: 400;
                border-bottom: 1px solid #d8dee4;
                margin-top: 10px;
            }

        </style>

<!--same as add_vehicle-->
        <style>
            .form-group {
                margin-top: 10px;
            }

            .form-group dt {
                margin: 0 0 6px;
                font-weight: 600;
            }

            .form-group .form-control {
                width: 440px;
                max-width: 100%;
                margin-right: 5px;
                box-sizing: border-box;
                background-color: #f6f8fa;

                padding: 5px 12px;
                font-size: 14px;
                line-height: 20px;
                color: #242927;
                vertical-align: middle;
                background-repeat: no-repeat;
                background-position: right 8px center;
                border: 1px solid #d0d7de;
                border-radius: 6px;
                box-shadow: inset 0 1px 0 rgba(208,215,222,0.2);
                transition: 80ms cubic-bezier(0.33, 1, 0.68, 1);
                transition-property: all;
                transition-property: color,background-color,box-shadow,border-color;
            }

            .form-group .form-control:focus {
                background-color: #ffffff;
            }

            .form-group .form-control:focus:not(:focus-visible){
                border-color: #0969da;
                outline: none;
                box-shadow: inset 0 0 0 1px transparent;
            }

            .form-group .form-control:focus-visible {
                border-color: #0969da;
                outline: none;
                box-shadow: inset 0 0 0 1px #0969da;
            }

        </style>

        <!--setting_panel_jh.css-->
        <style>
            #set_sec_jh ul {
                padding: 0;
                margin: 0;
                margin: 0 20px;
                margin-top: 10px;
            }

            #set_sec_jh li {
                background-color: var(--background-color);
                margin-bottom: 10px;
                box-shadow: 0 2px 5px #0002;
                border-radius: 15px;
                padding: 15px;
                transition: 0.3s;

                display: grid;
                grid-template-columns: 1fr auto;
            }

            #set_sec_jh i {
                display: flex;
                align-items: center;
                font-size: 1.6em;
            }

            #set_sec_jh .date {
                font-weight: 600;
            }

            #set_sec_jh .journey {
                display: grid;
                grid-template-columns: max-content max-content auto;
                grid-column-gap: 5px;
                align-items: center;
            }

            #set_sec_jh .stat {
                display: grid;
                /*grid-template-columns: 1fr 1fr;*/
                /*grid-column-gap: 10px;*/
                align-items: center;

                text-align: center;
                color: #242927;
                font-weight: 600;
                font-size: 1.1em;
            }
        </style>

        <!--setting_panel_pp.css-->
        <style>
            #set_sec_pp_content {
                display: flex;
                flex-direction: column;
                align-items: center;
                margin: 0 20px;
            }

            #set_sec_pp .circle {
                margin: 20px;
            }

            #set_sec_pp .circle i {
                font-size: 6em;
            }

            #set_sec_pp span {
                font-size: 1.3em;
                font-weight: 600;
            }

            #set_sec_pp .button-container {
                position: fixed;
                bottom: 10px;

                display: grid;
                grid-auto-columns: auto;
                grid-gap: 20px;
            }

            #set_sec_pp .button-container button {
                width: 150px;
                font-weight: 600;
            }

        </style>

        <!--setting_panel_sl.css-->
        <style>

            #set_sec_sl ul {
                padding: 0;
                margin: 0;
                margin: 0 20px;
                margin-top: 10px;
            }

            #set_sec_sl a {
                text-decoration: none;
                font-size: 1.2em;
                color: #444444;

                display: grid;
                grid-template-columns: auto 20px;

                background-color: var(--background-color);
                margin-bottom: 10px;
                box-shadow: 0 2px 5px #0002;
                border-radius: 15px;
                padding: 15px;
                transition: 0.3s;
            }

            #set_sec_sl i {
                display: none;
            }

            #set_sec_sl .active {
                display:contents;
            }


        </style>

        <!--setting_panel_bc.css-->
        <style>
            #set_sec_bc ul {
                padding: 0;
                margin: 0;
                margin: 0 20px;
                margin-top: 10px;
            }

            #set_sec_bc li {
                box-shadow: 1px 1px 4px rgba(0, 0, 0, 0.2);
                border-radius: 20px;
            }

            #set_sec_bc .card {
                background-color:#c1b9ff;

                /*texture bug (freeze)*/
                /*
                background-image: url("../img/01.-Royal-Heath.jpg");
                background-size: cover;
                */

                width: 400px;
                max-width: 100%;
                height: 200px;
                box-sizing: border-box;
                border-radius: 20px;

                display: grid;
                grid-template-rows: auto max-content max-content;
                grid-row-gap: 10px;

                padding: 10px 30px 30px 30px;
                box-shadow: inset 1px 1px 10px #ffffff;
                box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            }

            #set_sec_bc .card i {
                color: #242927;
                font-size: 4em;
            }

            #set_sec_bc .card .numbers {
                font-size: 1em;
                font-family: 'Space Mono';
            }

            #set_sec_bc .card .name {
                
                font-size: 1em;
                font-weight: 600;
            }
        </style>

    </head>
    <body>
        <section id="page-content">
            <h1>Settings</h1>

            <div id="user_info">
                <div id="user_name">
                    Full name
                </div>
                <div id="user_picture" class="circle">
                    <i class="fi fi-rr-user"></i>
                </div>
            </div>

            <div id="menu_setting">
                <a id="set_but_pp" href="#" class="settings_button">
                    <i id="ico_pp" class="fi fi-rr-user"></i>
                    <span class="button__text">Change your profile picture</span>
                </a>
                <a id="set_but_sl" href="#" class="settings_button">
                    <i id="ico_sl" class="fi fi-rr-flag"></i> <!--fi-rr-globe-->
                    <span class="button__text">Select language</span>
                </a>
                <a id="set_but_pi" href="#" class="settings_button">
                    <i id="ico_pi" class="fi fi-rr-info"></i>
                    <span class="button__text">Personal informations</span>
                </a>
                <a id="set_but_jh" href="#" class="settings_button">
                    <i id="ico_jh" class="fi fi-rr-time-past"></i>
                    <span class="button__text">Journey history</span>
                </a>
                <a id="set_but_bc" href="#" class="settings_button">
                    <i id="ico_bc" class="fi fi-rr-credit-card"></i>
                    <span class="button__text">My bank details</span>
                </a>
            </div>

            <div id="caution_container">
                <button id="delete_account_button" class="caution_button">Delete my account</button>
                <button id="log_out_button" class="caution_button">Log out</button>
            </div>

        </section>

        <section id="moving-screen">
            <div id="screen_header">
                <a id="sec_but_re" href="#">
                    <i id="ico_return" class="fi fi-rr-arrow-small-left"></i>
                </a>
                <h1 id="title">[Title]</h1>
            </div>
            
            <!--Page name-->
            <section id="set_sec_pp" class="section_moving" hidden>
                <div id="set_sec_pp_content">
                    <div class="circle">
                        <i class="fi fi-rr-user"></i>
                    </div>
                    <span>Look strait foward without sunglasses, and nobody next to you</span>
                    <div class="button-container">
                        <button id="take_picture_button">Take a picture</button>
                        <button id="choose_picture_button" class="border-button">Choose a picture</button>
                    </div>
                </div>
            </section>

            <section id="set_sec_sl" class="section_moving" hidden>
                <ul id="language_list">
                    <li>
                        <a id="english" href="#" class="lang__link">
                            <span class="lang__text">English</span>
                            <i class="fi fi-rr-check active"></i>
                        </a>
                    </li>
                    <!--
                    <li>
                        <a id="french" href="#" class="lang__link">
                            <span class="lang__text">Français</span>
                            <i class="fi fi-rr-check"></i>
                        </a>
                    </li>
                    -->
                </ul>
            </section>
    
            <section id="set_sec_pi" class="section_moving" hidden>
                <h2>Profile</h2>
                <form id="form-pi">
                    <div class="form-group">
                        <dt>Name</dt>
                        <dd>
                            <input id="pi_user_profile_name" class="form-control" type="text" name="" >
                        </dd>
                    </div>
                    <div class="form-group">
                        <dt>Email</dt>
                        <dd>
                            <input id="pi_user_email" class="form-control" type="email" name="" >
                        </dd>
                    </div>
                    <div class="form-group">
                        <dt>Phone number</dt>
                        <dd>
                            <input id="pi_user_phone_numbre" class="form-control" type="tel" name="" >
                        </dd>
                    </div>
                </form>
            </section>
    
            <section id="set_sec_jh" class="section_moving" hidden>
                <ul id="journey_history_list">
                    <li>
                        <div class="detail">
                            <div class="date">22 November 2022</div>
                            <div class="journey">
                                <span>Montpellier</span>
                                <i id="ico_arrow" class="fi fi-rr-arrow-small-right"></i>
                                <span>Paris</span>
                            </div>
                        </div>
                        <div class="stat">
                            <!--<span class="distance">300km</span>-->
                            <span class="price">70€</span>
                        </div>
                    </li>
                    <li>
                        <div class="detail">
                            <div class="date">24 December 2022</div>
                            <div class="journey">
                                <span>North Pole</span>
                                <i id="ico_arrow" class="fi fi-rr-arrow-small-right"></i>
                                <span>Toulon</span>
                            </div>
                        </div>
                        <div class="stat">
                            <!--<span class="distance">2800.3km</span>-->
                            <span class="price">999.99€</span>
                        </div>
                    </li>
                </ul>
            </section>
            
            <section id="set_sec_bc" class="section_moving" hidden>
                <ul>
                    <li>
                        <div class="card">
                            <div class="brand">
                                <i class="fi fi-brands-visa"></i>
                            </div>
                            <div class="numbers">
                                <span>1234 1567 1901 1425</span>
                            </div>
                            <div class="name">
                                <span>Isen</span>
                            </div>
                        </div>
                    </li>
                </ul>
            </section>
            
        </section>
       
        <!-- Popups message -->
        <div id="modal_popup" class="modal">
            <!-- Popup message for book a vehicle -->
            <div id="popup" class="popup">
                <h1>Delete your account?</h1>
                <div id="popup_information">
                    <i id="ico_warning" class="fi fi-rr-exclamation"></i>
                    <span>All of your informations will be deleted.</span>
                </div>
                <div id="popup_buttons">
                    <button id="but_pop_goback">No, go back</button>
                    <button id="but_pop_delete" class="border-button">Yes, delete</button>
                </div>
            </div>
        </div>

        <nav id="navigation" class="nav">
            <a id="nav_home" href="#" class="nav__link nav__link__ripple">
                <i id="ico_home" class="nav__icon fi fi-rr-home"></i>
                <span class="nav__text">Home</span>
            </a>
            <a id="nav_drive" href="#" class="nav__link nav__link__ripple">
                <i id="ico_drive" class="nav__icon fi fi-rr-search"></i>
                <span class="nav__text">Drive</span>
            </a>
            <a id="nav_vehicles" href="#" class="nav__link nav__link__ripple">
                <i id="ico_vehicles" class="nav__icon fi fi-rr-car"></i>
                <span class="nav__text">Vehicles</span>
            </a>
            <a id="nav_settings" href="#" class="nav__link nav__link__ripple nav__link--active">
                <i id="ico_settings" class="nav__icon fi fi-sr-settings"></i>
                <span class="nav__text">Settings</span>
            </a>
        </nav>

        <script src="../js/androidInterface.js"></script>
        <script src="../js/nav.js"></script>

        <script src="../js/popup.js"></script>
        <script src="../js/popup_delete.js"></script>

        <!--moving.js-->
        <script>
            
            const setting_page_pp = document.getElementById("moving-screen");

            setting_page_pp.addEventListener('touchstart', touchStart);
            setting_page_pp.addEventListener('touchmove', touchMove);
            setting_page_pp.addEventListener('touchend', touchEnd);

            var startingX, count;

            function touchStart(event) {
                startingX = event.touches[0].clientX;
                //console.log("start " + startingX);
                count = 0;
                setting_page_pp.style.transition = '0s';
            }

            function touchMove(event) {
                let change = event.touches[0].clientX - startingX;
                count++;
                // If move to right to left
                if(change < 0)
                    return;
                
                if(change > 50)
                    setting_page_pp.style.left = change - 50 + 'px';
                event.preventDefault();
            }

            function touchEnd(event) {
                let endedX = event.changedTouches[0].clientX;
                let change = endedX - startingX;

                setting_page_pp.style.transition = '0.3s ease-in-out';

                // If user move is < to 20px, ignore
                if (change < 20) {
                    return;
                }

                if(determinateChange(startingX, endedX, change, count)){
                    //console.log("rest");
                    setting_page_pp.style.left = '0px';
                } else {
                    //console.log("leave");
                    setting_page_pp.style.left = '101vw';
                }
            }

            function determinateChange(start, end, change, sample) {
                let speed =  change / sample;
                //console.log("-> start=" + start + "px, end=" + end + "px, diff=" + change + "px, nbr=" + sample + ", speed=" + speed);
                
                if(speed > 10){
                    //console.log("speed")
                    return false;
                }

                let threshold = screen.width / 2;
                if(change < threshold){
                    //console.log("threshold");
                    return true;
                }
                    
                return false;
            }
            
        </script>

        <!--settings.js-->
        <script>
            // On load page:
            if(androidConnected()) Android.requestUserName();

            // [ANDROID CALLBACK]
            function setUserName(name){
                let nameElmt = document.getElementById("user_name");
                nameElmt.textContent = name;
            }

            //

            const PROFILE_PICTURE_SCREEN = 0,
                SELECT_LANGUAGE_SCREEN = 1,
                PERSONAL_INFO_SCREEN = 2,
                JOURNEY_HISTORY_SCREEN = 3,
                BANK_DETAIL_SCREEN = 4;
            
            const buttons = document.querySelectorAll(".settings_button");
            const sections = document.querySelectorAll(".section_moving");

            buttons.forEach((btn, index) => {
                btn.addEventListener("click", function () {

                    if(androidConnected()) Android.openSlider();

                    /*
                    setting_page_pp.style.display = 'block';
                    setTimeout(function () {
                        setting_page_pp.style.left = '0px';
			        }, 10);
                    
                    // Set content
                    sections.forEach((sec) => sec.hidden = true);
                    sections[index].hidden = false;

                    // Set title
                    let title = document.getElementById("title");
                    switch (index) {
                        case PROFILE_PICTURE_SCREEN:
                            title.textContent = "Profile Picture";
                            break;
                        case SELECT_LANGUAGE_SCREEN:
                            title.textContent = "Languages";
                            break;
                        case PERSONAL_INFO_SCREEN:
                            title.textContent = "Personal Informations";
                            break;
                        case JOURNEY_HISTORY_SCREEN:
                            title.textContent = "History";
                            break;
                        case BANK_DETAIL_SCREEN:
                            title.textContent = "Bank details";
                            break;
                    
                        default:
                            break;
                    }
*/
                });
            });
                        
            const button_return = document.getElementById("sec_but_re");
            button_return.addEventListener("click", function () {
                setting_page_pp.style.left = '101vw';
            });



            // delete account:
            // Open popup "Are you sure ?"
            const delete_account_button = document.getElementById("delete_account_button");
            delete_account_button.addEventListener('click', function () {
                console.log("delete");
                openPopup(popup);
            });

            // Log out
            const logOutButton = document.getElementById("log_out_button");
            logOutButton.addEventListener('click', function () {
                console.log("logout");
                if(androidConnected()) Android.logout();
            });

        </script>

        <!--settings-personnal-info.js-->
        <script>
            // Reques
            if(androidConnected()) Android.requestPersonalInformation();

            // [ANDROID CALLBACK]
            function setUserInformation(userInfo){

                let user_info = JSON.parse(userInfo);

                // Show informations
                let form_personal_info = document.getElementById("form-pi");
                form_personal_info["pi_user_profile_name"].value = user_info.name;
                form_personal_info["pi_user_email"].value = user_info.email;
                form_personal_info["pi_user_phone_numbre"].value = user_info.phone;
            }
        </script>

    </body>
</html>
